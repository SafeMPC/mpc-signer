# Enterprise MPC Infrastructure
> é“¶è¡Œçº§å¤šæ–¹è®¡ç®—ï¼ˆMPCï¼‰æ•°å­—èµ„äº§æ‰˜ç®¡åŸºåº§

[![License](https://img.shields.io/badge/license-MIT-blue.svg)](LICENSE)
[![Go Version](https://img.shields.io/badge/go-1.21+-blue.svg)](go.mod)

**go-mpc-infra** æ˜¯ä¸€å¥—ä¼ä¸šçº§ MPC é’±åŒ…åŸºç¡€è®¾æ–½è§£å†³æ–¹æ¡ˆã€‚å®ƒåŸºäºé˜ˆå€¼ç­¾åæ–¹æ¡ˆï¼ˆThreshold Signature Scheme, TSSï¼‰æ„å»ºï¼Œæ—¨åœ¨ä¸ºäº¤æ˜“æ‰€ã€æ‰˜ç®¡æœºæ„ã€èµ„ç®¡å¹³å°æä¾›**ç§é’¥æ°¸ä¸å®Œæ•´å‡ºç°**ã€**æ— å•ç‚¹æ•…éšœ**ã€**ç­–ç•¥é©±åŠ¨**çš„æ•°å­—èµ„äº§ç®¡ç†èƒ½åŠ›ã€‚

ä¸åŒäºä¼ ç»Ÿå•ç§é’¥é’±åŒ…æˆ–å¤šé‡ç­¾åï¼ˆMultiSigï¼‰åˆçº¦ï¼Œæœ¬ç³»ç»Ÿåœ¨å¯†ç å­¦å±‚é¢å®ç°äº†é€šç”¨çš„å¤šæ–¹ååŒè®¡ç®—ï¼Œå¤©ç„¶æ”¯æŒæ‰€æœ‰åŸºäº ECDSA (Bitcoin, Ethereum) å’Œ EdDSA (Solana) çš„åŒºå—é“¾ç½‘ç»œï¼Œæ— éœ€é“¾ä¸Šåˆçº¦æ”¯æŒã€‚

---

## æ ¸å¿ƒèƒ½åŠ› (Capabilities)

### 1. ğŸ” é“¶è¡Œçº§å®‰å…¨æ¶æ„
- **ç§é’¥åˆ†ç‰‡å­˜å‚¨**ï¼šç§é’¥åœ¨ç”Ÿæˆç¬é—´å³è¢«åˆ‡åˆ†ä¸º $n$ ä¸ªåˆ†ç‰‡ï¼Œåˆ†æ•£å­˜å‚¨åœ¨ä¸åŒåœ°ç†ä½ç½®ã€ä¸åŒäº‘å‚å•†çš„èŠ‚ç‚¹ä¸­ã€‚ä»»ä½•å•ä¸€èŠ‚ç‚¹ï¼ˆç”šè‡³æ•°æ®åº“ï¼‰è¢«æ”»ç ´éƒ½æ— æ³•è¿˜åŸå®Œæ•´ç§é’¥ã€‚
- **MPC ååŒç­¾å**ï¼šäº¤æ˜“ç­¾åè¿‡ç¨‹éœ€ $t+1$ ä¸ªèŠ‚ç‚¹åœ¨çº¿ååŒè®¡ç®—ã€‚ç­¾åè¿‡ç¨‹ä¸­ç§é’¥åˆ†ç‰‡ä»ä¸ä¼ è¾“ã€ä¸æ±‡èšï¼Œä»…è¾“å‡ºæœ€ç»ˆç­¾åç»“æœã€‚
- **é›¶ä¿¡ä»»é‰´æƒ**ï¼šé›†æˆ **WebAuthn (Passkey)** æ ‡å‡†ï¼Œå¼ºåˆ¶è¦æ±‚ç¡¬ä»¶çº§ç”Ÿç‰©è¯†åˆ«ï¼ˆTouchID/FaceID/YubiKeyï¼‰è¿›è¡Œç®¡ç†æ“ä½œï¼Œæœç» API Key æ³„æ¼å¯¼è‡´çš„æƒé™æ»¥ç”¨ã€‚

### 2. ğŸŒ å¼¹æ€§åˆ†å¸ƒå¼ç½‘ç»œ
- **å»ä¸­å¿ƒåŒ–èŠ‚ç‚¹å‘ç°**ï¼šåŸºäº **Consul** çš„åŠ¨æ€æœåŠ¡å‘ç°æœºåˆ¶ï¼Œæ”¯æŒè®¡ç®—èŠ‚ç‚¹ï¼ˆParticipantsï¼‰çš„è‡ªåŠ¨åŒ–æ³¨å†Œä¸å¥åº·æ£€æŸ¥ã€‚
- **åŠ¨æ€æ‰©ç¼©å®¹**ï¼šè®¡ç®—èŠ‚ç‚¹æ— çŠ¶æ€åŒ–è®¾è®¡ï¼Œæ”¯æŒæ ¹æ®è´Ÿè½½åŠ¨æ€å¢åŠ èŠ‚ç‚¹ï¼Œè‡ªåŠ¨å‚ä¸ DKGï¼ˆåˆ†å¸ƒå¼å¯†é’¥ç”Ÿæˆï¼‰ä¸ç­¾åä»»åŠ¡ã€‚
- **é«˜å¯ç”¨å®¹ç¾**ï¼šæ”¯æŒ $t$ ä¸ªèŠ‚ç‚¹å®•æœºä¸å½±å“æœåŠ¡å¯ç”¨æ€§ã€‚

### 3. ğŸ›¡ ç­–ç•¥ä¸é£æ§å¼•æ“
- **å¤šå±‚çº§å®¡æ‰¹**ï¼šæ”¯æŒ M-of-N ç®¡ç†å‘˜å®¡æ‰¹ç­–ç•¥ï¼Œå…³é”®æ“ä½œï¼ˆå¦‚ä¿®æ”¹ç­–ç•¥ã€å¤§é¢è½¬è´¦ï¼‰éœ€å¤šä½ç®¡ç†å‘˜ Passkey ç­¾åæˆæƒã€‚
- **ç»†ç²’åº¦æƒé™**ï¼šåŸºäºè§’è‰²çš„è®¿é—®æ§åˆ¶ï¼ˆRBACï¼‰ï¼Œç²¾ç¡®æ§åˆ¶æˆå‘˜å¯¹é’±åŒ…çš„æ“ä½œæƒé™ã€‚

### 4. ğŸ”— å…¨é“¾é€šç”¨é€‚é…
- **é“¾æ— å…³æ€§ï¼ˆChain Agnosticï¼‰**ï¼šåº•å±‚ MPC åè®®ä¸ä¾èµ–ç‰¹å®šåŒºå—é“¾è™šæ‹Ÿæœºã€‚
- **å¹¿æ³›æ”¯æŒ**ï¼š
    - **ECDSA (secp256k1)**: Bitcoin, Ethereum, BSC, Tron ç­‰ã€‚
    - **EdDSA (Ed25519)**: Solana, Aptos, Sui, Cardano ç­‰ï¼ˆè§„åˆ’ä¸­ï¼‰ã€‚

---

## ç³»ç»Ÿæ¶æ„ (Architecture)

ç³»ç»Ÿé‡‡ç”¨æ§åˆ¶å¹³é¢ä¸è®¡ç®—å¹³é¢åˆ†ç¦»çš„è®¾è®¡ï¼š

```mermaid
graph TD
    User[ç”¨æˆ·/ä¸šåŠ¡ç³»ç»Ÿ] -->|REST/GRPC| Gateway[API Gateway]
    
    subgraph "Control Plane (æ§åˆ¶å¹³é¢)"
        Gateway -->|Auth & Policy| Coordinator[Coordinator Service]
        Coordinator -->|Meta| DB[(PostgreSQL)]
        Coordinator -->|Auth| WebAuthn[Passkey Verifier]
    end
    
    subgraph "Compute Plane (è®¡ç®—å¹³é¢)"
        Coordinator -->|P2P DKG/Sign| P1[Participant Node 1]
        Coordinator -->|P2P DKG/Sign| P2[Participant Node 2]
        Coordinator -->|P2P DKG/Sign| P3[Participant Node 3]
        
        P1 <--> P2
        P2 <--> P3
        P1 <--> P3
    end
    
    subgraph "Discovery & Config"
        Consul[Consul Service Registry]
        Vault[HashiCorp Vault (Optional)]
    end
    
    P1 -.->|Register| Consul
    P2 -.->|Register| Consul
    P3 -.->|Register| Consul
    Coordinator -.->|Discover| Consul
```

- **Coordinator (åè°ƒè€…)**ï¼šè´Ÿè´£è¯·æ±‚å—ç†ã€é‰´æƒã€ç­–ç•¥æ£€æŸ¥ã€ä»»åŠ¡è°ƒåº¦ï¼Œä¸æŒæœ‰ä»»ä½•ç§é’¥åˆ†ç‰‡ã€‚
- **Participants (å‚ä¸è€…)**ï¼šè´Ÿè´£å…·ä½“çš„ MPC å¯†ç å­¦è®¡ç®—ï¼ŒæŒæœ‰ç§é’¥åˆ†ç‰‡ï¼Œåœ¨éš”ç¦»ç¯å¢ƒä¸­è¿è¡Œã€‚

---

## å¿«é€Ÿå¼€å§‹ (Quick Start)

### å‰ç½®è¦æ±‚
- Docker & Docker Compose
- Go 1.21+

### 1. å¯åŠ¨åŸºç¡€è®¾æ–½
ä¸€é”®æ‹‰èµ· PostgreSQL, Redis, Consul åŠæ‰€æœ‰ MPC æœåŠ¡èŠ‚ç‚¹ï¼š
```bash
make up
```

### 2. è¿è¡Œç«¯åˆ°ç«¯ç³»ç»Ÿæµ‹è¯•
ç³»ç»Ÿå†…ç½®äº†å®Œæ•´çš„é›†æˆæµ‹è¯•ï¼Œæ¨¡æ‹Ÿä»èŠ‚ç‚¹æ³¨å†Œåˆ°äº¤æ˜“ç­¾åçš„å…¨æµç¨‹ï¼š
```bash
# éªŒè¯æ ¸å¿ƒæµç¨‹ï¼šèŠ‚ç‚¹å‘ç° -> DKG -> Passkeyè®¤è¯ -> TSSç­¾å
go run cmd/system-test/main.go
```

### 3. API äº¤äº’
æœåŠ¡å¯åŠ¨åï¼Œå¯ä»¥é€šè¿‡ Swagger UI æ¢ç´¢ APIï¼š
- åœ°å€: `http://localhost:8080/swagger/index.html` (éœ€å¼€å¯ Swagger æœåŠ¡)
- æ ¸å¿ƒæ¥å£ï¼š
    - `POST /v1/infra/keygen`: å‘èµ· DKG å¯†é’¥ç”Ÿæˆ
    - `POST /v1/infra/sign`: å‘èµ· MPC ç­¾å
    - `POST /v1/infra/wallets/{id}/policy`: è®¾ç½®é£æ§ç­–ç•¥

---

## è·¯çº¿å›¾ (Roadmap)

- [x] **Phase 1: æ ¸å¿ƒåŸºåº§ (Current)**
    - GG18/GG20 åè®®å®ç°
    - Consul åŠ¨æ€èŠ‚ç‚¹å‘ç°
    - WebAuthn ç¡¬ä»¶é‰´æƒ
    - åŸºç¡€ç­–ç•¥å¼•æ“
- [ ] **Phase 2: å¢å¼ºä¸æ‰©å±•**
    - FROST (Schnorr) åè®®æ”¯æŒ
    - å¯†é’¥é‡æ–°åˆ†ç‰‡ (Re-sharing / Key Rotation)
    - ç¦»çº¿ç­¾åæ”¯æŒ (Cold Storage)
- [ ] **Phase 3: ä¼ä¸šçº§äº¤ä»˜**
    - TEE (SGX/Nitro) ç¡¬ä»¶çº§éš”ç¦»æ”¯æŒ
    - ç§»åŠ¨ç«¯ App ååŒç­¾å
    - å®Œæ•´çš„å®¡è®¡åå°

## è®¸å¯è¯
MIT License
